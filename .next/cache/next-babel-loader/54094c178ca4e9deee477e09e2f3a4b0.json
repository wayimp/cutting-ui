{"ast":null,"code":"import _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\n\nvar _this = this,\n    _jsxFileName = \"/Users/keith/cutting-ui/pages/reports.js\",\n    _s = $RefreshSig$();\n\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useState, useEffect } from 'react';\nimport Router from 'next/router';\nimport axiosClient from '../src/axiosClient';\nimport { connect } from 'react-redux';\nimport { compose } from 'redux';\nimport { wrapper } from '../components/store';\nimport { fade, makeStyles, useTheme } from '@material-ui/core/styles';\nimport { getLangString } from '../components/Lang';\nimport Link from '../src/Link';\nimport TopBar from '../components/TopBar';\nimport AddLocationIcon from '@material-ui/icons/AddLocation';\nimport LocationOnIcon from '@material-ui/icons/LocationOn';\nimport SendIcon from '@material-ui/icons/Send';\nimport numeral from 'numeral';\nvar priceFormat = '$0.00';\nimport OrderCard from '../components/OrderCard';\nimport { flatten } from 'lodash';\nimport moment from 'moment';\nvar dateFormat = 'YYYY-MM-DDTHH:mm:SS';\nvar dateDisplay = 'dddd MMMM DD';\nimport { Container, Card, Grid, Paper, List, ListItem, ListItemAvatar, ListItemText, Typography, Table, TableBody, TableCell, TableRow, FormControl, InputLabel, Input, FormHelperText, Button, Modal, Backdrop, Fade, TextField } from '@material-ui/core';\nimport { Map as GoogleMap, InfoWindow, Marker, GoogleApiWrapper } from 'google-maps-react';\nimport { useSnackbar } from 'notistack';\nimport cookie from 'js-cookie';\nvar useStyles = makeStyles(function (theme) {\n  var _ref;\n\n  return _ref = {\n    toolbar: _objectSpread({\n      display: 'flex',\n      alignItems: 'center',\n      justifyContent: 'flex-end',\n      padding: theme.spacing(0, 1)\n    }, theme.mixins.toolbar),\n    center: {\n      textAlign: 'center'\n    },\n    content: {\n      textAlign: 'center',\n      flexGrow: 1,\n      padding: theme.spacing(7)\n    },\n    root: {\n      flexGrow: 1\n    }\n  }, _defineProperty(_ref, \"center\", {\n    textAlign: 'center',\n    flexGrow: 1\n  }), _defineProperty(_ref, \"lines\", {\n    display: 'flex',\n    justifyContent: 'flex-end',\n    flexGrow: 1,\n    borderTop: '1px solid #ccc',\n    borderLeft: '1px solid #ccc',\n    borderRight: '1px solid #ccc',\n    '&:last-child': {\n      borderBottom: '1px solid #ccc'\n    }\n  }), _defineProperty(_ref, \"nolines\", {\n    borderBottom: '2px solid white'\n  }), _defineProperty(_ref, \"flexGrid\", {\n    display: 'flex',\n    justifyContent: 'flex-end',\n    flexGrow: 1\n  }), _defineProperty(_ref, \"modal\", {\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'center'\n  }), _defineProperty(_ref, \"section\", {\n    backgroundColor: '#EEF',\n    border: '1px solid #AAA',\n    margin: '5px',\n    padding: '8px'\n  }), _ref;\n});\n\nvar Page = function Page(_ref2) {\n  _s();\n\n  var dispatch = _ref2.dispatch,\n      lang = _ref2.lang,\n      cart = _ref2.cart,\n      google = _ref2.google,\n      token = _ref2.token;\n  var classes = useStyles();\n  var theme = useTheme();\n  var langSuffix = lang ? lang.substring(0, 2) : 'en';\n\n  var _React$useState = React.useState(false),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      open = _React$useState2[0],\n      setOpen = _React$useState2[1];\n\n  var _React$useState3 = React.useState([]),\n      _React$useState4 = _slicedToArray(_React$useState3, 2),\n      reports = _React$useState4[0],\n      setreports = _React$useState4[1];\n\n  var _useSnackbar = useSnackbar(),\n      enqueueSnackbar = _useSnackbar.enqueueSnackbar;\n\n  var getData = function getData() {\n    console.log('token:' + token);\n    dispatch({\n      type: 'SEGMENT',\n      payload: 'reports'\n    });\n    axiosClient({\n      method: 'get',\n      url: '/reports',\n      headers: {\n        Authorization: \"Bearer \".concat(token)\n      }\n    }).then(function (response) {\n      setreports(Array.isArray(response.data) ? response.data : []);\n    });\n  };\n\n  var onFocus = function onFocus() {\n    getData();\n  };\n\n  useEffect(function () {\n    window.addEventListener('focus', onFocus);\n    return function () {\n      window.removeEventListener('focus', onFocus);\n    };\n  });\n  var reportsSorted = reports.map(function (order) {\n    return _objectSpread(_objectSpread({}, order), {}, {\n      daySubmitted: moment(order.timeline[0].timestamp, dateFormat).locale(lang.substring(0, 2)).format(dateDisplay)\n    });\n  }).sort(function (a, b) {\n    var dateA = new Date(a.timeline[0].timestamp),\n        dateB = new Date(b.timeline[0].timestamp);\n    return dateB - dateA;\n  });\n  var days = Array.isArray(reportsSorted) ? _toConsumableArray(new Set(reportsSorted.map(function (order) {\n    return order.daySubmitted;\n  }))) : [];\n\n  var handleOpen = function handleOpen() {\n    setOpen(true);\n  };\n\n  var handleClose = function handleClose() {\n    setOpen(false);\n  };\n\n  useEffect(function () {\n    alert('checking token in effect:' + JSON.stringify(token));\n\n    if (token && token.length > 0) {\n      getData();\n    } else {//Router.push('/')\n    }\n  }, []);\n  return __jsx(Container, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 176,\n      columnNumber: 5\n    }\n  }, __jsx(TopBar, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 177,\n      columnNumber: 7\n    }\n  }), __jsx(\"main\", {\n    className: classes.content,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 178,\n      columnNumber: 7\n    }\n  }, __jsx(\"div\", {\n    className: classes.toolbar,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 179,\n      columnNumber: 9\n    }\n  }), __jsx(\"div\", {\n    className: classes.root,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 180,\n      columnNumber: 9\n    }\n  }, days.map(function (day) {\n    return __jsx(Card, {\n      key: day,\n      className: classes.section,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 182,\n        columnNumber: 13\n      }\n    }, __jsx(\"h3\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 183,\n        columnNumber: 15\n      }\n    }, day), __jsx(Grid, {\n      container: true,\n      spacing: 2,\n      direction: \"row\",\n      justify: \"flex-start\",\n      alignItems: \"flex-start\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 184,\n        columnNumber: 15\n      }\n    }, reportsSorted.filter(function (border) {\n      return border.daySubmitted === day;\n    }).map(function (border) {\n      return __jsx(OrderCard, {\n        key: border._id,\n        border: border,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 194,\n          columnNumber: 21\n        }\n      });\n    })));\n  }))));\n};\n\n_s(Page, \"Yv4g4kGp4zqOAhFr/BdxESuldCc=\", false, function () {\n  return [useStyles, useTheme, useSnackbar];\n});\n\n_c = Page;\nexport default connect(function (state) {\n  return state;\n})(Page);\n\nvar _c;\n\n$RefreshReg$(_c, \"Page\");","map":{"version":3,"sources":["/Users/keith/cutting-ui/pages/reports.js"],"names":["React","useState","useEffect","Router","axiosClient","connect","compose","wrapper","fade","makeStyles","useTheme","getLangString","Link","TopBar","AddLocationIcon","LocationOnIcon","SendIcon","numeral","priceFormat","OrderCard","flatten","moment","dateFormat","dateDisplay","Container","Card","Grid","Paper","List","ListItem","ListItemAvatar","ListItemText","Typography","Table","TableBody","TableCell","TableRow","FormControl","InputLabel","Input","FormHelperText","Button","Modal","Backdrop","Fade","TextField","Map","GoogleMap","InfoWindow","Marker","GoogleApiWrapper","useSnackbar","cookie","useStyles","theme","toolbar","display","alignItems","justifyContent","padding","spacing","mixins","center","textAlign","content","flexGrow","root","borderTop","borderLeft","borderRight","borderBottom","backgroundColor","border","margin","Page","dispatch","lang","cart","google","token","classes","langSuffix","substring","open","setOpen","reports","setreports","enqueueSnackbar","getData","console","log","type","payload","method","url","headers","Authorization","then","response","Array","isArray","data","onFocus","window","addEventListener","removeEventListener","reportsSorted","map","order","daySubmitted","timeline","timestamp","locale","format","sort","a","b","dateA","Date","dateB","days","Set","handleOpen","handleClose","alert","JSON","stringify","length","day","section","filter","_id","state"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react'\nimport Router from 'next/router'\nimport axiosClient from '../src/axiosClient'\nimport { connect } from 'react-redux'\nimport { compose } from 'redux'\nimport { wrapper } from '../components/store'\nimport { fade, makeStyles, useTheme } from '@material-ui/core/styles'\nimport { getLangString } from '../components/Lang'\nimport Link from '../src/Link'\nimport TopBar from '../components/TopBar'\nimport AddLocationIcon from '@material-ui/icons/AddLocation'\nimport LocationOnIcon from '@material-ui/icons/LocationOn'\nimport SendIcon from '@material-ui/icons/Send'\nimport numeral from 'numeral'\nconst priceFormat = '$0.00'\nimport OrderCard from '../components/OrderCard'\nimport { flatten } from 'lodash'\nimport moment from 'moment'\nconst dateFormat = 'YYYY-MM-DDTHH:mm:SS'\nconst dateDisplay = 'dddd MMMM DD'\nimport {\n  Container,\n  Card,\n  Grid,\n  Paper,\n  List,\n  ListItem,\n  ListItemAvatar,\n  ListItemText,\n  Typography,\n  Table,\n  TableBody,\n  TableCell,\n  TableRow,\n  FormControl,\n  InputLabel,\n  Input,\n  FormHelperText,\n  Button,\n  Modal,\n  Backdrop,\n  Fade,\n  TextField\n} from '@material-ui/core'\nimport {\n  Map as GoogleMap,\n  InfoWindow,\n  Marker,\n  GoogleApiWrapper\n} from 'google-maps-react'\nimport { useSnackbar } from 'notistack'\nimport cookie from 'js-cookie'\n\nconst useStyles = makeStyles(theme => ({\n  toolbar: {\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'flex-end',\n    padding: theme.spacing(0, 1),\n    // necessary for content to be below app bar\n    ...theme.mixins.toolbar\n  },\n  center: {\n    textAlign: 'center'\n  },\n  content: {\n    textAlign: 'center',\n    flexGrow: 1,\n    padding: theme.spacing(7)\n  },\n  root: {\n    flexGrow: 1\n  },\n  center: {\n    textAlign: 'center',\n    flexGrow: 1\n  },\n  lines: {\n    display: 'flex',\n    justifyContent: 'flex-end',\n    flexGrow: 1,\n    borderTop: '1px solid #ccc',\n    borderLeft: '1px solid #ccc',\n    borderRight: '1px solid #ccc',\n    '&:last-child': {\n      borderBottom: '1px solid #ccc'\n    }\n  },\n  nolines: {\n    borderBottom: '2px solid white'\n  },\n  flexGrid: {\n    display: 'flex',\n    justifyContent: 'flex-end',\n    flexGrow: 1\n  },\n  modal: {\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'center'\n  },\n  section: {\n    backgroundColor: '#EEF',\n    border: '1px solid #AAA',\n    margin: '5px',\n    padding: '8px'\n  }\n}))\n\nconst Page = ({ dispatch, lang, cart, google, token }) => {\n  const classes = useStyles()\n  const theme = useTheme()\n  const langSuffix = lang ? lang.substring(0, 2) : 'en'\n  const [open, setOpen] = React.useState(false)\n  const [reports, setreports] = React.useState([])\n  const { enqueueSnackbar } = useSnackbar()\n\n  const getData = () => {\n    console.log('token:' + token)\n    dispatch({ type: 'SEGMENT', payload: 'reports' })\n    axiosClient({\n      method: 'get',\n      url: '/reports',\n      headers: { Authorization: `Bearer ${token}` }\n    }).then(response => {\n      setreports(Array.isArray(response.data) ? response.data : [])\n    })\n  }\n\n  const onFocus = () => {\n    getData()\n  }\n\n  useEffect(() => {\n    window.addEventListener('focus', onFocus)\n    return () => {\n      window.removeEventListener('focus', onFocus)\n    }\n  })\n\n  const reportsSorted = reports\n    .map(order => ({\n      ...order,\n      daySubmitted: moment(order.timeline[0].timestamp, dateFormat)\n        .locale(lang.substring(0, 2))\n        .format(dateDisplay)\n    }))\n    .sort(function (a, b) {\n      const dateA = new Date(a.timeline[0].timestamp),\n        dateB = new Date(b.timeline[0].timestamp)\n      return dateB - dateA\n    })\n\n  const days = Array.isArray(reportsSorted)\n    ? [...new Set(reportsSorted.map(order => order.daySubmitted))]\n    : []\n\n  const handleOpen = () => {\n    setOpen(true)\n  }\n\n  const handleClose = () => {\n    setOpen(false)\n  }\n\n  useEffect(() => {\n    alert('checking token in effect:' + JSON.stringify(token))\n    if (token && token.length > 0) {\n      getData()\n    } else {\n      //Router.push('/')\n    }\n  }, [])\n\n  return (\n    <Container>\n      <TopBar />\n      <main className={classes.content}>\n        <div className={classes.toolbar} />\n        <div className={classes.root}>\n          {days.map(day => (\n            <Card key={day} className={classes.section}>\n              <h3>{day}</h3>\n              <Grid\n                container\n                spacing={2}\n                direction='row'\n                justify='flex-start'\n                alignItems='flex-start'\n              >\n                {reportsSorted\n                  .filter(border => border.daySubmitted === day)\n                  .map(border => (\n                    <OrderCard key={border._id} border={border} />\n                  ))}\n              </Grid>\n            </Card>\n          ))}\n        </div>\n      </main>\n    </Container>\n  )\n}\n\nexport default connect(state => state)(Page)\n"]},"metadata":{},"sourceType":"module"}