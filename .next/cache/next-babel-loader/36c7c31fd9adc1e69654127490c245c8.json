{"ast":null,"code":"var _jsxFileName = \"/Users/keith/cutting-ui/components/OrderCard.js\";\nvar __jsx = React.createElement;\nimport React from 'react';\nimport { connect } from 'react-redux';\nimport { makeStyles } from '@material-ui/core/styles';\nimport clsx from 'clsx';\nimport { red } from '@material-ui/core/colors';\nimport { Avatar, Box, Card, CardHeader, CardContent, CardActions, Collapse, IconButton, Container, Grid, Typography, Link, Table, TableBody, TableCell, TableContainer, TableHead, TableRow, Paper } from '@material-ui/core';\nimport LaunchIcon from '@material-ui/icons/Launch';\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\nimport MoreVertIcon from '@material-ui/icons/MoreVert';\nimport moment from 'moment';\nconst dateFormat = 'YYYY-MM-DDTHH:mm:SS';\nconst dateDisplay = 'dddd h:mm a';\nimport { getLangString } from '../components/Lang';\nimport numeral from 'numeral';\nconst priceFormat = '$0.00';\n\nArray.prototype.sum = function (prop) {\n  let total = Number(0);\n\n  for (let i = 0, _len = this.length; i < _len; i++) {\n    total += Number(this && this[i] && this[i][prop] ? this[i][prop] : 0);\n  }\n\n  return total;\n};\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    maxWidth: 345,\n    margin: 6\n  },\n  grid: {\n    marginTop: -30,\n    paddingBottom: 20\n  },\n  expand: {\n    transform: 'rotate(0deg)',\n    marginLeft: 'auto',\n    transition: theme.transitions.create('transform', {\n      duration: theme.transitions.duration.shortest\n    })\n  },\n  expandOpen: {\n    transform: 'rotate(180deg)'\n  }\n}));\n\nconst OrderCard = ({\n  border,\n  lang\n}) => {\n  const classes = useStyles();\n  const [expanded, setExpanded] = React.useState(false);\n  const langSuffix = lang ? lang.substring(0, 2) : 'en';\n\n  const handleExpandClick = () => {\n    setExpanded(!expanded);\n  };\n\n  const bvendors = Array.isArray(border.bproducts) ? [...new Set(border.bproducts.map(bproduct => bproduct.bvendor))] : [];\n  let whatsAppScrubbed = border.whatsApp.replace(/[^0-9.]/g, '');\n\n  if (whatsAppScrubbed.startsWith('6')) {\n    whatsAppScrubbed = '507' + whatsAppScrubbed;\n  }\n\n  return __jsx(Card, {\n    className: classes.root,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 5\n    }\n  }, __jsx(CardHeader, {\n    action: __jsx(IconButton, {\n      \"aria-label\": getLangString('reports.detail', lang),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 11\n      }\n    }, __jsx(Link, {\n      href: `https://www.boquetemarket.com/order/${border._id}`,\n      target: border._id,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 13\n      }\n    }, __jsx(LaunchIcon, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 15\n      }\n    }))),\n    title: border.name,\n    subheader: moment(border.timeline[0].timestamp, dateFormat).locale(lang.substring(0, 2)).format(dateDisplay),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 7\n    }\n  }), __jsx(CardContent, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 7\n    }\n  }, __jsx(Grid, {\n    className: classes.grid,\n    container: true,\n    spacing: 2,\n    direction: \"row\",\n    justify: \"flex-start\",\n    alignItems: \"flex-start\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 9\n    }\n  }, bvendors.map(bvendor => {\n    return __jsx(\"figure\", {\n      key: bvendor,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 114,\n        columnNumber: 15\n      }\n    }, __jsx(\"img\", {\n      src: `https://boqueteeats.s3.us-east-2.amazonaws.com/${bvendor}/logo.png`,\n      style: {\n        height: 48\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 115,\n        columnNumber: 17\n      }\n    }), __jsx(\"figcaption\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 119,\n        columnNumber: 17\n      }\n    }, numeral(border.bproducts.filter(bproduct => bproduct.bvendor === bvendor).sum('lineTotal')).format(priceFormat)));\n  })), __jsx(Link, {\n    href: 'https://wa.me/' + whatsAppScrubbed,\n    target: \"_new\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 9\n    }\n  }, 'WhatsApp: ' + whatsAppScrubbed), __jsx(Typography, {\n    variant: \"body2\",\n    color: \"textSecondary\",\n    component: \"p\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 9\n    }\n  }, border.timeline.length > 1 ? border.timeline[border.timeline.length - 1][`description_${langSuffix}`] : '')));\n};\n\nexport default connect(state => state)(OrderCard);","map":{"version":3,"sources":["/Users/keith/cutting-ui/components/OrderCard.js"],"names":["React","connect","makeStyles","clsx","red","Avatar","Box","Card","CardHeader","CardContent","CardActions","Collapse","IconButton","Container","Grid","Typography","Link","Table","TableBody","TableCell","TableContainer","TableHead","TableRow","Paper","LaunchIcon","ExpandMoreIcon","MoreVertIcon","moment","dateFormat","dateDisplay","getLangString","numeral","priceFormat","Array","prototype","sum","prop","total","Number","i","_len","length","useStyles","theme","root","maxWidth","margin","grid","marginTop","paddingBottom","expand","transform","marginLeft","transition","transitions","create","duration","shortest","expandOpen","OrderCard","border","lang","classes","expanded","setExpanded","useState","langSuffix","substring","handleExpandClick","bvendors","isArray","bproducts","Set","map","bproduct","bvendor","whatsAppScrubbed","whatsApp","replace","startsWith","_id","name","timeline","timestamp","locale","format","height","filter","state"],"mappings":"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","sourcesContent":["import React from 'react'\nimport { connect } from 'react-redux'\nimport { makeStyles } from '@material-ui/core/styles'\nimport clsx from 'clsx'\nimport { red } from '@material-ui/core/colors'\nimport {\n  Avatar,\n  Box,\n  Card,\n  CardHeader,\n  CardContent,\n  CardActions,\n  Collapse,\n  IconButton,\n  Container,\n  Grid,\n  Typography,\n  Link,\n  Table,\n  TableBody,\n  TableCell,\n  TableContainer,\n  TableHead,\n  TableRow,\n  Paper\n} from '@material-ui/core'\n\nimport LaunchIcon from '@material-ui/icons/Launch'\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore'\nimport MoreVertIcon from '@material-ui/icons/MoreVert'\nimport moment from 'moment'\nconst dateFormat = 'YYYY-MM-DDTHH:mm:SS'\nconst dateDisplay = 'dddd h:mm a'\nimport { getLangString } from '../components/Lang'\nimport numeral from 'numeral'\nconst priceFormat = '$0.00'\n\nArray.prototype.sum = function (prop) {\n  let total = Number(0)\n  for (let i = 0, _len = this.length; i < _len; i++) {\n    total += Number(this && this[i] && this[i][prop] ? this[i][prop] : 0)\n  }\n  return total\n}\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    maxWidth: 345,\n    margin: 6\n  },\n  grid: {\n    marginTop: -30,\n    paddingBottom: 20\n  },\n  expand: {\n    transform: 'rotate(0deg)',\n    marginLeft: 'auto',\n    transition: theme.transitions.create('transform', {\n      duration: theme.transitions.duration.shortest\n    })\n  },\n  expandOpen: {\n    transform: 'rotate(180deg)'\n  }\n}))\n\nconst OrderCard = ({ border, lang }) => {\n  const classes = useStyles()\n  const [expanded, setExpanded] = React.useState(false)\n  const langSuffix = lang ? lang.substring(0, 2) : 'en'\n\n  const handleExpandClick = () => {\n    setExpanded(!expanded)\n  }\n\n  const bvendors = Array.isArray(border.bproducts)\n    ? [...new Set(border.bproducts.map(bproduct => bproduct.bvendor))]\n    : []\n\n  let whatsAppScrubbed = border.whatsApp.replace(/[^0-9.]/g, '')\n  if (whatsAppScrubbed.startsWith('6')) {\n    whatsAppScrubbed = '507' + whatsAppScrubbed\n  }\n\n  return (\n    <Card className={classes.root}>\n      <CardHeader\n        action={\n          <IconButton aria-label={getLangString('reports.detail', lang)}>\n            <Link\n              href={`https://www.boquetemarket.com/order/${border._id}`}\n              target={border._id}\n            >\n              <LaunchIcon />\n            </Link>\n          </IconButton>\n        }\n        title={border.name}\n        subheader={moment(border.timeline[0].timestamp, dateFormat)\n          .locale(lang.substring(0, 2))\n          .format(dateDisplay)}\n      />\n      <CardContent>\n        <Grid\n          className={classes.grid}\n          container\n          spacing={2}\n          direction='row'\n          justify='flex-start'\n          alignItems='flex-start'\n        >\n          {bvendors.map(bvendor => {\n            return (\n              <figure key={bvendor}>\n                <img\n                  src={`https://boqueteeats.s3.us-east-2.amazonaws.com/${bvendor}/logo.png`}\n                  style={{ height: 48 }}\n                />\n                <figcaption>\n                  {numeral(\n                    border.bproducts\n                      .filter(bproduct => bproduct.bvendor === bvendor)\n                      .sum('lineTotal')\n                  ).format(priceFormat)}\n                </figcaption>\n              </figure>\n            )\n          })}\n        </Grid>\n        <Link href={'https://wa.me/' + whatsAppScrubbed} target='_new'>\n          {'WhatsApp: ' + whatsAppScrubbed}\n        </Link>\n        <Typography variant='body2' color='textSecondary' component='p'>\n          {border.timeline.length > 1\n            ? border.timeline[border.timeline.length - 1][\n                `description_${langSuffix}`\n              ]\n            : ''}\n        </Typography>\n      </CardContent>\n\n      {/*\n      <CardActions disableSpacing>\n        <IconButton\n          className={clsx(classes.expand, {\n            [classes.expandOpen]: expanded\n          })}\n          onClick={handleExpandClick}\n          aria-expanded={expanded}\n          aria-label='show more'\n        >\n          <ExpandMoreIcon />\n        </IconButton>\n      </CardActions>\n      <Collapse in={expanded} timeout='auto' unmountOnExit>\n        <CardContent>\n        \n          {bvendors.map(bvendor => {\n            return (\n              \n              <figure key={bvendor}>\n                <figcaption>\n                  {currencyFormat(\n                    border.bproducts\n                      .filter(bproduct => bproduct.bvendor === bvendor)\n                      .sum('price')\n                  )}\n                </figcaption>\n              </figure>\n            )\n          })}\n        </CardContent>\n      </Collapse>\n      */}\n    </Card>\n  )\n}\n\nexport default connect(state => state)(OrderCard)\n"]},"metadata":{},"sourceType":"module"}